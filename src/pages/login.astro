---
// src/pages/login.astro
import MainLayout from '../layouts/MainLayout.astro';
import AuthForm from '../components/AuthForm.jsx';
import { createServerClient } from "@supabase/ssr";

const { url } = Astro.request;

const {
  data: { session },
} = await createServerClient(
  import.meta.env.PUBLIC_SUPABASE_URL,
  import.meta.env.PUBLIC_SUPABASE_ANON_KEY,
  {
    cookies: {
      get: (key) => Astro.cookies.get(key)?.value,
      set: (key, value, options) => Astro.cookies.set(key, value, options),
      remove: (key, options) => Astro.cookies.delete(key, options),
    },
  }
).auth.getSession();

if (session) {
  return Astro.redirect("/");
}
---

<MainLayout title="Login / Daftar - BJS RACING STORE">
  <div class="container mx-auto px-4 py-16">
    <h1 class="text-3xl font-bold text-center mb-8">Akun Saya</h1>
    <AuthForm client:only="react" />
  </div>
</MainLayout>